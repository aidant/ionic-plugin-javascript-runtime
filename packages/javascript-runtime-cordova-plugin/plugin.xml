<?xml version="1.0" encoding="UTF-8"?>
<plugin
  xmlns="http://apache.org/cordova/ns/plugins/1.0"
  id="javascript-runtime-cordova-plugin"
  version="1.0.0"
>
  <engines>
    <engine name="cordova" version="^9.0.0" />
    <engine name="cordova-android" version="^8.0.0" />
    <engine name="cordova-ios" version="^5.0.0" />
  </engines>

  <name>JavaScriptRuntime</name>
  <description></description>
  <author></author>
  <keywords></keywords>
  <license></license>

  <hook type="after_plugin_install" src="hooks/set-preferences.js" />
  <hook type="before_build" src="hooks/set-preferences.js" />

  <platform name="android">
    <config-file target="res/xml/config.xml" parent="/*">
      <preference name="GradlePluginKotlinEnabled" value="true" />

      <feature name="JavaScriptRuntimePlugin">
        <param name="android-package" value="org.apache.cordova.plugins.javascript_runtime.JavaScriptRuntimePlugin" />
      </feature>
    </config-file>

    <framework src="android/build-extras.gradle" custom="true" type="gradleReference" />

    <preference name="JAVASCRIPT_RUNTIME_LIB" default="../deno/lib" />
    <preference name="JAVASCRIPT_RUNTIME_PROFILE" default="release" />

    <source-file src="android/org/apache/cordova/plugins/javascript_runtime/JavaScriptRuntimePlugin.kt" target-dir="java/org/apache/cordova/plugins/javascript_runtime/" />
    <source-file src="$JAVASCRIPT_RUNTIME_LIB/lib/android/uniffi/javascript_runtime/javascript_runtime.kt" target-dir="java/uniffi/javascript_runtime/" />

    <resource-file src="$JAVASCRIPT_RUNTIME_LIB/lib/android/uniffi/javascript_runtime/aarch64-linux-android/$JAVASCRIPT_RUNTIME_PROFILE/libjavascript_runtime.so" target="jniLibs/arm64-v8a/libjavascript_runtime.so" />
    <resource-file src="$JAVASCRIPT_RUNTIME_LIB/lib/android/uniffi/javascript_runtime/x86_64-linux-android/$JAVASCRIPT_RUNTIME_PROFILE/libjavascript_runtime.so" target="jniLibs/x86_64/libjavascript_runtime.so" />
  </platform>

  <platform name="ios"></platform>
</plugin>
